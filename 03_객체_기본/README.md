# 03_객체_기본 (요약)

## 3.1 객체
- 객체의 키(식별자)는 문자열이나 심볼만 허용됩니다.
- 프로퍼티 접근은 점 표기법 또는 대괄호 표기법으로 할 수 있습니다.
- 해당 key를 가진 프로퍼티가 객체 내에 있는지 확인하고자 할 때: `"key" in obj`
- 프로퍼티를 나열할 때: `for (let key in obj)`
- 객체에는 특별한 정렬 방식이 있습니다.
  - 정수 프로퍼티(integer property)는 자동으로 정렬되고, 그 외의 프로퍼티는 객체에 추가한 순서 그대로 정렬됩니다. 


## 3.2 참조에 의한 객체 복사
- 객체는 참조에 의해 저장되고 복사됩니다.
- 객체의 복사본을 만들려면 `Object.assign()`을 사용한 얕은 복사(중첩 객체를 처리하지 못함)나 `_.cloneDeep(obj)`를 사용한 깊은 복사를 합니다.


## 3.3 가비지 컬렉션
- 자바스크립트 엔진 내에선 가비지 컬렉터가 끊임없이 도달 불가능한 객체를 메모리에서 삭제합니다.
- 태생부터 도달 가능한 값 "루트"
  - 현재 함수의 지역 변수와 매개변수, 중첩 함수의 체인에 있는 함수에서 사용되는 변수와 매개변수, 전역 변수 등등
  - 명백한 이유 없이는 삭제되지 않습니다.
- 루트가 참조하는 값이나 체이닝으로 루트에서 참조할 수 있는 값은 도달 가능한 값이 됩니다.
- 가비지 컬렉션 기본 알고리즘은 'mark-and-sweep'이며, 다양한 최적화 기법이 있습니다.


## 3.4 메서드와 this
- 객체 프로퍼티에 할당된 함수를 메서드라고 합니다.
- 메서드는 `this`로 객체를 참조합니다. 
- 자바스크립트의 `this` 값은 여타 언어들과 달리 런타임에 결정됩니다.
- 화살표 함수는 일반 함수와 달리 외부 일반 함수에서 `this` 값을 가져옵니다.


## 3.5 new 연산자와 생성자 함수
- 생성자 함수(짧게 줄여서 생성자)는 일반 함수입니다. 관례적으로 함수 이름 첫 글자를 대문자로 씁니다.
- 반드시 `new` 연산자와 함께 호출합니다. 빈 객체를 만들어 `this`에 할당하고, 함수를 실행한 후, this를 반환합니다.  
  return 문이 있는 경우, 객체를 리턴한다면 `this` 대신 객체가 반환되고, 원시형을 리턴한다면 무시됩니다.
- `new.target`


## 3.6 옵셔널 체이닝 '?.'
- `?.`는 왼쪽 평가 대상이 `null`이나 `undefined`면 평가를 멈춘 후 `undefined`를 반환합니다(단락 평가).
- `?.`는 연산자가 아니라 문법 구조체(syntax construct)입니다. 세 가지 형태로 사용할 수 있습니다.
  1) `obj?.prop` – obj가 존재하면 obj.prop을 반환하고, 그렇지 않으면 undefined를 반환함  
  2) `obj?.[prop]` – obj가 존재하면 obj[prop]을 반환하고, 그렇지 않으면 undefined를 반환함  
  3) `obj?.method()` – obj가 존재하면 obj.method()를 호출하고, 그렇지 않으면 undefined를 반환함
- 읽기나 삭제(`delete` 사용)에는 사용할 수 있지만 쓰기에는 사용할 수 없습니다.
- 새로 추가된 문법이라 구식 브라우저는 폴리필이 필요합니다.


## 3.7 심볼형
- Symbol은 원시형 데이터로, 유일무이한 식별자를 만드는 데 사용됩니다.
- 심볼은 이름(설명)이 같더라도 값이 항상 다릅니다. 이름이 같을 때 값도 같길 원한다면 전역 symbol 레지스트리를 사용해야 합니다.
- 심볼형은 '언어 차원의 보호장치'를 통해 문자형 등으로 자동 형변환 되지 않습니다.
- 외부 코드에서 접근이 불가능하고 값도 덮어쓸 수 없는 ‘숨김’ 프로퍼티를 만들 수 있습니다.  
  서드파티 코드에 속한 객체에 새로운 프로퍼티를 안전하게 추가하고 싶을 때 사용합니다.
- 객체 리터럴을 사용해 객체를 만든 경우, 대괄호를 사용해 심볼형 키를 만들어야 합니다.
- `for .. in`과 `Object.keys()`에서 배제되지만, `Object.assign`에선 복사됩니다.
- 자바스크립트 내부에서 사용되는 시스템 심볼은 `Symbol.*`로 접근할 수 있습니다.  
  이를 사용해 내장 메서드 등의 기본 동작을 입맛대로 변경할 수 있습니다.


## 3.8 객체를 원시형으로 변환하기
- 원시값을 기대하는 내장 함수나 연산자를 사용할 때 객체는 자동으로 원시형으로 형 변환됩니다.
- 형 변환은 'hint'(목표로 하는 자료형)를 기준으로 세 종류로 구분할 수 있습니다.
  1) "string" (alert 같이 문자열을 필요로 하는 연산)
  2) "number" (수학 연산)
  3) "default"
- `default`는 연산자가 기대하는 피연산자를 '확신할 수 없을 때’입니다. 아주 드물게 발생합니다.  
  `Date`를 제외한 모든 내장 객체는 "default"와 "number"일 때를 동일하게 처리합니다. 
- 형 변환엔 다음 알고리즘이 적용됩니다.
  1) 객체에 `obj[Symbol.toPrimitive](hint)`메서드가 있는지 찾고, 있다면 호출합니다.
  2) 1에 해당하지 않고 hint가 "string"이라면, `obj.toString()`을, 없다면 `obj.valueOf()`를 호출합니다.
  3) 1과 2에 해당하지 않고, hint가 "number"나 "default"라면, `obj.valueOf()`를, 없다면 `obj.toString()`을 호출합니다.
- `toString`과 `valueOf`의 실행규칙
  hint에 명시된 자료형으로의 형변환을 보장하진 않지만, 반드시 원시값을 반환합니다.

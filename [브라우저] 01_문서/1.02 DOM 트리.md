# DOM 트리

모든 HTML 태그는 객체입니다. 태그 하나가 감싸고 있는 자식 태그는 **중첩 태그(nested tag)** 라고 부릅니다. 태그 내의 문자(text) 역시 객체입니다.

모든 객체는 자바스크립트를 통해 접근할 수 있습니다.

<br><br>

## DOM 예제

먼저 DOM 구조에 대해 알아봅시다.

HTML/XML 문서는 브라우저 안에서 DOM 트리로 표현됩니다.

![image](https://user-images.githubusercontent.com/65887537/199629935-4ab16984-dc8f-4ba4-8a11-9afd31aa374e.png)

트리에 있는 노드는 모두 객체입니다.

태그는 **요소 노드(element node)** (혹은 그냥 **요소**)이고, 트리 구조를 구성합니다. 

`<html>`은 루트 노드입니다.

요소 내의 문자는 **텍스트(text) 노드**가 됩니다. `#text`처럼 문자열만 담고, 자식 노드를 가질 수 없습니다.

새 줄`↵`과 공백`␣`은 항상 유효한 문자로 취급되어 텍스트 노드가 됩니다. 위 문서에서 `<head>`와 `<title>`사이 줄과 공백 역시 `#text` 노드가 됩니다. 하지만 두 가지 예외가 있습니다.

1. 역사적인 이유로, `<head>` 이전의 공백과 새 줄은 무시됩니다.
2. HTML 명세서에 따라 모든 콘텐츠는 `body` 안쪽에 있어야 합니다. `</body>` 뒤에 무언가를 넣더라도 자동으로 `body` 안쪽으로 옮겨집니다. 따라서 `</body>` 뒤엔 공백이 있을 수 없습니다.

<br><br>

### 💡 문자열 양 끝 공백과 공백만 있는 텍스트 노드는 개발자 도구에서 보이지 않습니다. 화면을 덜 차지하기 위해서입니다.

<br><br>

## 자동 교정

기형적인 HTML을 만나면 브라우저는 **DOM 생성과정에서 HTML을 자동으로 교정**합니다.

몇 가지 예시: 

* 최상위 태그는 항상 `<html>`이어야 하는데 없는 경우 자동으로 넣어줍니다. HTML 파일에 `"안녕하세요."` 문장 하나만 저장돼있다면, 자동으로 `<html>` 과 `<body>`로 감싸고 `<head>`를 추가합니다.
* 닫는 태그가 없는 에러 등도 자동으로 처리합니다. 최종 결과물은 정상적인 DOM이 됩니다.
* **🚨 테이블엔 언제나 `<tbody>`가 있습니다.** DOM 명세서에 따르면 테이블에 반드시 `<tbody>`가 있어야 하지만, HTML에선 생략하곤 합니다. 이때, 브라우저가 자동으로 DOM에 만들어줍니다.

<br><br>

## 기타 노드 타입

요소와 텍스트 노드 외에도 다양한 노드 타입이 있습니다. 주석도 **주석 노드(comment node)** 가 됩니다.

![image](https://user-images.githubusercontent.com/65887537/199631732-4ad3189b-b2c6-4043-97ce-74ce48819d43.png)

화면 출력물에 영향을 주지 않는데 DOM에는 추가되는 이유는, HTML에 뭔가 있다면 반드시 DOM 트리에 추가되어야 한다는 규칙 때문입니다. **HTML 안의 모든 것은 DOM을 구성합니다.** `<!DOCTYPE...>` 지시자와 문서 전체를 나타내는 `document` 객체 또한 DOM 노드입니다.

<br><br>

노드 타입은 **총 열두 가지** 인데, 실무에선 주로 네 가지를 다룹니다.

1. DOM의 '진입점'이 되는 `document` 노드
2. HTML 태그에서 만들어지며, DOM 트리를 구성하는 블록인 요소 노드(element node)
3. 텍스트를 포함하는 텍스트 노드(text node)
4. 화면에 보이지는 않지만, 자바스크립트를 사용해 DOM으로부터 읽어올 수 있는 주석(comment) 노드

<br><br>

## DOM 구조 직접 보기

### Live DOM Viewer

[Live DOM Viewer](http://software.hixie.ch/utilities/js/live-dom-viewer/)에서 실시간으로 DOM 구조를 볼 수 있습니다. 

### 브라우저 개발자 도구

대부분은 브라우저 개발자 도구를 사용합니다. 이때 생략된 부분이 있다는 점에 유의하시길 바랍니다. 텍스트 노드는 그냥 텍스트로만 표시되고, 띄어쓰기만 있는 빈 텍스트 노드는 나타나지 않습니다. 

좌측 상단의 ![image](https://user-images.githubusercontent.com/65887537/199632361-ef2a1d07-aa94-444c-afd7-36eeb50146e3.png) 버튼을 클릭한 후, 웹페이지 상의 노드를 클릭하면, Elements 패널의 해당 노드로 이동하여 자세히 볼 수 있습니다. 요소에 마우스 오른쪽 버튼 클릭하고 'Inspect'를 클릭해도 같은 기능을 사용할 수 있습니다.

Elements 패널의 우측 하위 패널을 살펴보면:

* **Styles** – 내장 규칙(회색 배경)을 포함하여 현재 요소에 적용된 CSS 규칙을 보여줍니다. 
  하단부에 있는 크기(dimension), 마진(margin), 패딩(padding)을 비롯한 스타일 대부분을 패널에서 바로 수정해 볼 수 있습니다.
* **Computed** – 현재 요소에 적용된 CSS 규칙을 프로퍼티 기준으로 보여줍니다. CSS 상속 등을 통해 적용된 규칙도 볼 수 있습니다.
* **Event Listeners** – DOM 요소에 붙은 이벤트 리스너를 볼 수 있습니다.
* 기타 등등

<br><br>

## 콘솔을 사용해 DOM 다루기

개발자 도구에서 DOM에 바로 자바스크립트를 적용해 보고 싶을때 팁입니다. 

먼저:

1. Elements 패널에서 요소를 선택하세요.
2. `Esc`를 눌러 Elements 패널 아래에 콘솔을 띄우세요.
3. 이제 가장 **마지막에 선택했던 요소는 `$0`으로, 그 이전에 선택했던 요소는 `$1`로 접근**할 수 있습니다.   
   (예: `$0.style.background = 'red'`)

또 다른 방법도 있습니다. DOM 노드를 참조하는 변수가 있는 경우 콘솔에 `inspect(node)` 명령어를 입력하면 Elements 패널에서 해당 요소가 강조되는 것을 확인할 수 있습니다.

아니면 `document.body`처럼 DOM 노드를 콘솔 창에 출력해서 탐색해볼 수도 있습니다.

<br>

### 개발자 도구의 다양한 기능은 [개발자 도구 문서 사이트](https://developers.google.com/web/tools/chrome-devtools)에서 확인할 수 있습니다.

<br><br><br>

출처: https://ko.javascript.info/dom-nodes#ref-3599
